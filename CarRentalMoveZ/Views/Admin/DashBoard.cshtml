@model CarRentalMoveZ.DTOs.DashboardDTO


@{
    ViewData["Title"] = "Dashboard";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}



<!-- KPI Cards Row -->
<div class="row g-3 mb-3">
    <!-- Card 1 -->
    <div class="col-12 col-md-3">
        <div class="card p-3 kpi">
            <h6>Total Bookings</h6>
            <div class="d-flex align-items-center justify-content-between">
                <h3>@Model.TotalBookings</h3>
                <span class="chip-up"><i class="bi bi-arrow-up-right"></i> 11.2%</span>
            </div>
            <div class="muted small">from last week</div>
        </div>
        <!-- Buttons under Card 1 -->
        <div class="d-flex gap-2 mt-2">
            <a asp-controller="Admin" asp-action="AddCar" class="btn btn-sm w-50 py-2" style="background-color:#1E56A0; color:#fff;">Add Car</a>
            <a asp-controller="Admin" asp-action="AddDriver" class="btn btn-sm w-50 py-2" style="background-color:#1E56A0; color:#fff;">Add Driver</a>
        </div>
    </div>

    <!-- Card 2 -->
    <div class="col-12 col-md-3">
        <div class="card p-3 kpi">
            <h6>Total Revenue</h6>
            <div class="d-flex align-items-center justify-content-between">
                <h3>@Model.TotalRevenue.ToString("C", System.Globalization.CultureInfo.CreateSpecificCulture("en-LK"))</h3>
                <span class="chip-up"><i class="bi bi-arrow-up-right"></i> 12.6%</span>
            </div>
            <div class="muted small">from last week</div>
        </div>
        <!-- Buttons under Card 2 -->
        <div class="d-flex gap-2 mt-2">
            <a asp-controller="Admin" asp-action="AddOffer" class="btn btn-sm w-50 py-2" style="background-color:#1E56A0; color:#fff;">Add Offer</a>
            <a asp-controller="Admin" asp-action="AddStaff" class="btn btn-sm w-50 py-2" style="background-color:#1E56A0; color:#fff;">Add Staff</a>
        </div>
    </div>

    <!-- Card 3 -->
    <div class="col-12 col-md-3">
        <div class="card p-3 kpi">
            <h6>Available Cars / Total Cars</h6>
            <div class="d-flex align-items-center justify-content-between">
                <h3>@Model.AvailableCars / @Model.TotalCars</h3>
                <span class="chip-dn"><i class="bi bi-arrow-down-right"></i> 2.8%</span>
            </div>
            <div class="muted small">from last week</div>
        </div>
        <!-- Buttons under Card 3 -->
        <div class="d-flex gap-2 mt-2">
            <a asp-controller="Admin" asp-action="ManageBookings" class="btn btn-sm w-50 py-2" style="background-color:#1E56A0; color:#fff;">Bookings</a>
            <a asp-controller="Admin" asp-action="ManageCar" class="btn btn-sm w-50 py-2" style="background-color:#1E56A0; color:#fff;">Cars</a>
        </div>
    </div>

    <!-- Card 4 -->
    <div class="col-12 col-md-3">
        <div class="card p-3 kpi">
            <h6>Total Customers</h6>
            <div class="d-flex align-items-center justify-content-between">
                <h3>@Model.TotalCustomers</h3>
                <span class="chip-up"><i class="bi bi-arrow-up-right"></i> 3.4%</span>
            </div>
            <div class="muted small">from last week</div>
        </div>
        <!-- Buttons under Card 4 -->
        <div class="d-flex gap-2 mt-2">
            <a asp-controller="Admin" asp-action="ManageCustomer" class="btn btn-sm w-50 py-2" style="background-color:#1E56A0; color:#fff;">Customers</a>
            <a asp-controller="Admin" asp-action="Cashier" class="btn btn-sm w-50 py-2" style="background-color:#1E56A0; color:#fff;">Cashier</a>
        </div>
    </div>
</div>

<div class="row g-3">
    <div class="col-12">
        <div class="d-flex" style="gap:1rem;">
            <!-- Bar Chart: fixed width -->
            <div class="card p-3" style="width:65%;">
                <div class="fw-semibold mb-2">Earnings Summary</div>
                <div style="height:300px;">
                    <canvas id="earningsChart"></canvas>
                </div>
            </div>

            <!-- Pie Chart: fixed width -->
            <div class="card p-3" style="width:25%;">
                <div class="fw-semibold mb-2">Rent Status <span class="small text-muted">(This Week)</span></div>
                <div style="height:230px;">
                    <canvas id="rentStatusChart"></canvas>
                </div>
                <div class="mt-2 small">
                    <div class="d-flex justify-content-between"><span>Booked</span><span>58%</span></div>
                    <div class="d-flex justify-content-between"><span>Pending</span><span>24%</span></div>
                    <div class="d-flex justify-content-between"><span>Cancelled</span><span>18%</span></div>
                </div>
            </div>

            <!-- New Chart: fills remaining space -->
            <div class="card p-3 flex-grow-1">
                <div class="fw-semibold mb-2">New Chart</div>
                <div style="height:300px;">
                    <canvas id="newChart"></canvas>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        /* Line: Earnings */
        new Chart(document.getElementById('earningsChart'), {
            type: 'line',
            data: {
                labels: ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug"],
                datasets: [{
                    label: "Revenue",
                    data: [8000,11000,10000,18450,12000,15000,13000,14000],
                    borderColor: "#1E56A0",
                    backgroundColor: "rgba(30,86,160,.12)",
                    fill: true,
                    tension: .4,
                    pointRadius: 3
                }]
            },
            options: {
                maintainAspectRatio: false,
                plugins: { legend: { display: false } },
                scales: {
                    y: { grid: { color: "rgba(0,0,0,.05)" } },
                    x: { grid: { display: false } }
                }
            }
        });

        /* Doughnut: Rent Status */
        new Chart(document.getElementById('rentStatusChart'), {
            type: 'doughnut',
            data: {
                labels: ["Booked","Pending","Cancelled"],
                datasets: [{
                    data: [58,24,18],
                    backgroundColor: ["#1E56A0","#f59f00","#6c757d"]
                }]
            },
            options: {
                maintainAspectRatio: false,
                cutout: "65%",
                plugins: { legend: { position: "bottom" } }
            }
        });

  
    </script>
}
