@model CarRentalMoveZ.DTOs.CustomerDashboardDTO

@{
    ViewData["Title"] = "Dashboard";
    Layout = "~/Views/Shared/_CustomerLayout.cshtml";
}

<div class="container mt-5">

    <!-- Profile Card -->
    <div class="row mb-4">
        <div class="col-md-12">
            <div class="profile-card p-4 d-flex align-items-center"
                 style="background: #D6E4F0; border-radius:20px; box-shadow:0 8px 25px rgba(0,0,0,0.08); transition: transform 0.3s;">
                <div class="profile-img me-4">
                    <img src="~/Img/client1.jpg" alt="Profile Picture" class="rounded-circle" width="100" height="100" />
                </div>
                <div>
                    <h3 class="text-dark fw-bold">@Model.Profile.Name</h3>
                    <p class="text-primary mb-1"><strong>Email:</strong> @Model.Profile.Email</p>
                    <p class="text-primary mb-1"><strong>Phone:</strong> @Model.Profile.PhoneNumber</p>
                    <a asp-controller="Customer" asp-action="EditProfile"
                       class="btn mt-3 fw-semibold"
                       style="background-color:#163172; color:#fff; border-radius:12px; padding:8px 20px; box-shadow:0 4px 12px rgba(0,0,0,0.1);">
                        ✏️ Edit Profile
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Summary Cards -->
    <div class="row mb-4 g-3">
        @* Summary Card Template *@
        <div class="col-md-4">
            <div class="card text-white" style="background-color:#1E56A0; border-radius:15px; box-shadow:0 8px 20px rgba(0,0,0,0.1); transition: transform 0.3s;">
                <div class="card-body text-center py-4">
                    <h6 class="text-light fw-semibold">Total Bookings</h6>
                    <h3 class="fw-bold">@Model.Bookings?.Count()</h3>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card text-white" style="background-color:#1E56A0; border-radius:15px; box-shadow:0 8px 20px rgba(0,0,0,0.1);">
                <div class="card-body text-center py-4">
                    <h6 class="text-light fw-semibold">Active Bookings</h6>
                    <h3 class="fw-bold">@Model.Bookings?.Count(b => b.Status == "Confirmed")</h3>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card text-white" style="background-color:#1E56A0; border-radius:15px; box-shadow:0 8px 20px rgba(0,0,0,0.1);">
                <div class="card-body text-center py-4">
                    <h6 class="text-light fw-semibold">Total Payments</h6>
                    <h3 class="fw-bold">
                        @Model.Payments?.Sum(p => p.Amount).ToString("C", System.Globalization.CultureInfo.CreateSpecificCulture("en-LK"))
                    </h3>
                </div>
            </div>
        </div>
    </div>

    <!-- Bookings Table -->
    <div class="row mb-4">
        <div class="col-md-12">
            <div class="card" style="border-radius:20px; box-shadow:0 8px 20px rgba(0,0,0,0.05);">
                <div class="card-header" style="background-color:#163172; color:#fff; border-radius:20px 20px 0 0;">
                    <h5 class="mb-0 fw-bold">My Bookings</h5>
                </div>
                <div class="card-body p-0">
                    <div class="table-responsive">
                        <table class="table mb-0 table-hover align-middle">
                            <thead style="background-color:#D6E4F0; color:#163172; font-weight:600;">
                                <tr>
                                    <th>#</th>
                                    <th>Car</th>
                                    <th>Dates</th>
                                    <th>Location</th>
                                    <th>Payment</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                @if (Model.Bookings != null && Model.Bookings.Any())
                                {
                                    foreach (var booking in Model.Bookings)
                                    {
                                        <tr>
                                            <td>@booking.BookingId</td>
                                            <td>@booking.CarModel</td>
                                            <td>@booking.StartDate.ToString("MMM dd, yyyy") - @booking.EndDate.ToString("MMM dd, yyyy")</td>
                                            <td>@booking.Location</td>
                                            <td>@booking.Payment.ToString("C", System.Globalization.CultureInfo.CreateSpecificCulture("en-LK"))</td>
                                            <td>
                                                <span class="badge" style="
                                                            background-color:@(booking.Status == "Confirmed" ? "#28a745" : booking.Status == "Pending" ? "#ffc107" : "#6c757d");
                                                            color:#fff; padding:5px 10px; border-radius:12px;">
                                                    @booking.Status
                                                </span>
                                            </td>
                                        </tr>
                                    }
                                }
                                else
                                {
                                    <tr><td colspan="6" class="text-center text-muted py-3">No bookings yet.</td></tr>
                                }
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Payments Table -->
    <div class="row mb-4">
        <div class="col-md-12">
            <div class="card" style="border-radius:20px; box-shadow:0 8px 20px rgba(0,0,0,0.05);">
                <div class="card-header" style="background-color:#163172; color:#fff; border-radius:20px 20px 0 0;">
                    <h5 class="mb-0 fw-bold">My Payments</h5>
                </div>
                <div class="card-body p-0">
                    <div class="table-responsive">
                        <table class="table mb-0 table-hover align-middle">
                            <thead style="background-color:#D6E4F0; color:#163172; font-weight:600;">
                                <tr>
                                    <th>#</th>
                                    <th>Booking Dates</th>
                                    <th>Amount</th>
                                    <th>Payment Date</th>
                                    <th>Method</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                @if (Model.Payments != null && Model.Payments.Any())
                                {
                                    foreach (var payment in Model.Payments)
                                    {
                                        <tr>
                                            <td>@payment.PaymentId</td>
                                            <td>@payment.BookingStartDate.ToString("MMM dd, yyyy") - @payment.BookingEndDate.ToString("MMM dd, yyyy")</td>
                                            <td>@payment.Amount.ToString("C", System.Globalization.CultureInfo.CreateSpecificCulture("en-LK"))</td>
                                            <td>@payment.PaymentDate.ToString("MMM dd, yyyy")</td>
                                            <td>@payment.PaymentMethod</td>
                                            <td>
                                                <span class="badge" style="
                                                            background-color:@(payment.Status == "Paid" ? "#28a745" : payment.Status == "Pending" ? "#ffc107" : "#dc3545");
                                                            color:#fff; padding:5px 10px; border-radius:12px;">
                                                    @payment.Status
                                                </span>
                                            </td>
                                        </tr>
                                    }
                                }
                                else
                                {
                                    <tr><td colspan="6" class="text-center text-muted py-3">No payments found.</td></tr>
                                }
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>

<style>
    /* Hover effect for cards */
    .profile-card:hover, .card:hover {
        transform: translateY(-5px);
    }

    /* Table row hover */
    .table-hover tbody tr:hover {
        background-color: #F6F6F6;
        transition: background-color 0.3s;
    }

    /* Responsive tables rounded corners */
    .table-responsive {
        border-radius: 0 0 20px 20px;
        overflow: hidden;
    }
</style>
